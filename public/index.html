<!DOCTYPE html>

<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<title>Naucna studija: HDR</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="/css/cocoen.min.css">
	<style>
		body {
			font-family: sans-serif;
			font-size: 16px;
			margin: 2rem;
			text-align: center;
			background: rgb(96, 102, 105) !important;
		}

		.hdr-image {
			max-width: 2145px !important;
			max-height: 1450px !important;
		}

		.container {
			position: relative;
			margin: auto;
			max-width: 2145px !important;
			/* velicina odabrana zbog velicina slika u dataset-u, promijeniti u skladu sa buduce koristenim datasetom */
			text-align: center;
		}
	</style>
</head>

<body>

	<nav class="navbar sticky-top navbar-light bg-light">
		<a class="navbar-brand" href="#">
			<img src="/img/etfbl.png" width="60" height="60" class="d-inline-block align-top" alt="">
		</a>
		<p style="font-size: 36px;">Inverzno tonsko mapiranje slika</p>
		<span class="navbar-text" style="text-align: left">
			<p class="mb-1">Kandidat: Debeljak Savo</p>
			<p class="mb-1">Mentor: Vladimir Risojević</p>
			<p class="mb-1">Član komisije: Vladan Stojnić</p>
		</span>
	</nav>

	<h1 style="text-align: center" class="m-5">Korištene slike - LDR format</h1>

	<div id="carousel" class="carousel slide container" data-ride="carousel">
		<ol class="carousel-indicators" id="carousel-indicators-ldr">

		</ol>
		<div class="carousel-inner" id="carousel-inner">

		</div>
		<a class="carousel-control-prev" href="#carousel" role="button" data-slide="prev">
			<span class="carousel-control-prev-icon" aria-hidden="true"></span>
			<span class="sr-only">Previous</span>
		</a>
		<a class="carousel-control-next" href="#carousel" role="button" data-slide="next">
			<span class="carousel-control-next-icon" aria-hidden="true"></span>
			<span class="sr-only">Next</span>
		</a>
	</div>

	<form method="POST" action="/data">
		<div class="container" id="hdr-images-container">
			<h1 class="m-5">Slike</h1>
			<h2>Ispod se nalazi serija slika i polje za unos korisničkog imena (indeks). Od ispitanika se traži da
				zaokruži koja slika mu se vizuelno više dopada. Između slika se nalazi vertikalni klizač kako bi
				ispitanik mogao da uporedi efikasno i efektivno detalje na slici. Test nije vremenski ograničen.
			</h2>
			<input class="form-control mt-5 mb-5" required type="text"
				style="width:400px; margin-left:calc(50% - 200px); font-size: 30px;" placeholder="Korisničko ime: XXXX-YY"
				name="username">
		</div>
	</form>

	<br>
	<br><br><br>

</body>

<footer>
	<!-- <script src="/js/cocoen.min.js"></script> -->
	<script src="/js/custom/cocoen.canvas.js"></script>
	<script src="https://code.jquery.com/jquery-3.4.1.js"
		integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=" crossorigin="anonymous"></script>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
		integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
		integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous">
	</script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
		integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous">
	</script>
	<script src="/js/hdrpng.min.js"></script>
	<script>
		$(document).ready(() => {

			let dict = {};

			jQuery.get({
				url: '/images',
				success: (result) => {
					const ldrImages = result.filter(image => image.split("\.")[1].includes("jpg")); // ldr
					let ldrIndicatorContainer = $("#carousel-indicators-ldr");
					let innerCarousel = $("#carousel-inner");

					ldrImages.forEach((ldrImage, index) => {
						let listItem = document.createElement("li");
						$(listItem).attr("data-target", "#carousel");
						$(listItem).attr("data-slide-to", index);
						if (index == 0) $(listItem).addClass("active");
						ldrIndicatorContainer.append(listItem);

						let carouselItem = document.createElement("div");
						$(carouselItem).addClass("carousel-item");
						if (index == 0) $(carouselItem).addClass("active");
						let image = document.createElement("img");
						$(image).addClass("d-block w-100");
						$(image).attr("src", ldrImage);
						$(image).attr("alt", ldrImage);
						$(carouselItem).append(image);
						let captionItem = document.createElement("div");
						$(captionItem).addClass("carousel-caption d-none d-md-block");
						let h4Item = document.createElement("h4");
						$(h4Item).html(ldrImage.split("/")[2].split("\.")[0].toUpperCase().split(
							"_").join(" "));
						let h5Item = document.createElement("h5");
						$(h5Item).html(
							`Format: ${ldrImage.split("/")[2].split("\.")[1].toUpperCase()}`);
						$(captionItem).append(h4Item);
						$(captionItem).append(h5Item);
						$(carouselItem).append(captionItem);
						innerCarousel.append(carouselItem);
					});

					const hdrImages = result.filter(image => image.split("\.")[1].includes("hdr")).slice(
						0, 9); // ogranici na prva 3 radi testiranja zasad
					console.log(hdrImages);
					let hdrContainer = $("#hdr-images-container");
					hdrImages.forEach((hdrImage, index) => {
						let el = document.createElement("h1");
						let id = hdrImage.split("\.")[0].split("_")[0].split("/")[2];
						
						if (index % 3 == 0) {
							dict[id] = `container-${id}-${id}_CC`;
							console.log(dict);
							el.innerHTML = `1: ${id} v 2: ${id}_CC v 3: ${id}_TT`;

							let selectDiv = document.createElement("div");
							$(selectDiv).css("width", "fit-content");
							
							$(selectDiv).addClass("input-group mb-3");
							let prependDiv = document.createElement("div");
							$(prependDiv).addClass("input-group-prepend");
							let prependLabel = document.createElement("label");
							$(prependLabel).addClass("input-group-text");
							$(prependLabel).attr("for", `select-${id}`);
							$(prependLabel).html("<h2>Moguće opcije</h2>");
							$(prependDiv).append(prependLabel);
							$(selectDiv).css("margin-left", `calc(50% - 280px)`);
							$(selectDiv).append(prependDiv);
							let selectElement = document.createElement("select");
							$(selectElement).addClass("custom-select h2");
							$(selectElement).attr("id", `select-${id}`)
							$(selectElement).css("font-size", "30px");
							let optionOne = document.createElement("option");
							$(optionOne).attr("selected", "true");
							$(optionOne).html(`${id} v ${id}_CC`);
							$(optionOne).attr("value", `${id}-${id}_CC`);
							$(optionOne).addClass("h2");
							$(selectElement).append(optionOne);
							let optionTwo = document.createElement("option");
							$(optionTwo).html(`${id} v ${id}_TT`);
							$(optionTwo).attr("value", `${id}-${id}_TT`);
							$(optionTwo).addClass("h2");
							$(selectElement).append(optionTwo);
							let optionThree = document.createElement("option");
							$(optionThree).html(`${id}_CC v ${id}_TT`);
							$(optionThree).attr("value", `${id}_CC-${id}_TT`);
							$(optionThree).addClass("h2");
							$(selectElement).append(optionThree);
							$(selectDiv).append(selectElement);

							$(hdrContainer).append(el);
							$(hdrContainer).append(selectDiv);

							// zasad napravljeno da prikazuje par onih par slika iz druge baze, kad dobijem svoje slike promijeniti u skladu
							// sa nazivima slika

							let firstContainer = document.createElement("div");
							$(firstContainer).addClass("cocoen m-5");
							$(firstContainer).attr("id", `container-${id}-${id}_CC`);
							let outerDiv = document.createElement("div");
							let firstCanvasDiv = document.createElement("div");
							$(firstCanvasDiv).attr("id", `first-canvas-${id}`);
							$(outerDiv).append(firstCanvasDiv);
							$(firstContainer).append(outerDiv);
							let myFirstHDR = new HDRImage();
							myFirstHDR.src = hdrImage;
							$(firstCanvasDiv).append(myFirstHDR);
							let mySecondHDR = new HDRImage();
							mySecondHDR.src = hdrImage.replace(id, `${id}_CC`);
							// mySecondHDR.id = `second-canvas-${id}`;
							$(mySecondHDR).addClass("hdr-image");
							$(firstContainer).append(mySecondHDR);
							$(hdrContainer).append(firstContainer);
							new Cocoen($(firstCanvasDiv).attr("id"), $(firstContainer).attr("id"));

							let secondContainer = document.createElement("div");
							$(secondContainer).addClass("cocoen m-5");
							$(secondContainer).attr("id", `container-${id}-${id}_TT`);
							let secondOuterDiv = document.createElement("div");
							let secondCanvasDiv = document.createElement("div");
							$(secondCanvasDiv).attr("id", `second-canvas-${id}`);
							$(secondOuterDiv).append(secondCanvasDiv);
							$(secondContainer).append(secondOuterDiv);
							let mySecondFirstHDR = new HDRImage();
							mySecondFirstHDR.src = hdrImage;
							$(secondCanvasDiv).append(mySecondFirstHDR);
							let mySecondSecondHDR = new HDRImage();
							mySecondSecondHDR.src = hdrImage.replace(id, `${id}_TT`);
							// mySecondSecondHDR.id = `second-canvas-${id}`;
							$(mySecondSecondHDR).addClass("hdr-image");
							$(secondContainer).append(mySecondSecondHDR);
							$(hdrContainer).append(secondContainer);
							new Cocoen($(secondCanvasDiv).attr("id"), $(secondContainer).attr("id"));
							$(secondContainer).hide();

							let thirdContainer = document.createElement("div");
							$(thirdContainer).addClass("cocoen m-5");
							$(thirdContainer).attr("id", `container-${id}_CC-${id}_TT`);
							let thirdOuterDiv = document.createElement("div");
							let thirdCanvasDiv = document.createElement("div");
							$(thirdCanvasDiv).attr("id", `third-canvas-${id}`);
							$(thirdOuterDiv).append(thirdCanvasDiv);
							$(thirdContainer).append(thirdOuterDiv);
							let mythirdFirstHDR = new HDRImage();
							mythirdFirstHDR.src = hdrImage.replace(id, `${id}_CC`);
							$(thirdCanvasDiv).append(mythirdFirstHDR);
							let myThirdSecondHDR = new HDRImage();
							myThirdSecondHDR.src = hdrImage.replace(id, `${id}_TT`);
							// mySecondSecondHDR.id = `second-canvas-${id}`;
							$(myThirdSecondHDR).addClass("hdr-image");
							$(thirdContainer).append(myThirdSecondHDR);
							$(hdrContainer).append(thirdContainer);
							new Cocoen($(thirdCanvasDiv).attr("id"), $(thirdContainer).attr("id"));
							$(thirdContainer).hide();

							$(hdrContainer).append(getRadioOptions(id));
							$(hdrContainer).append(getRadioOptions(`${id}_CC`));
							$(hdrContainer).append(getRadioOptions(`${id}_TT`));
							let hrElement = document.createElement("hr");
							$(hrElement).css("color", "white");
							$(hdrContainer).append(hrElement);
						}

					});

					let buttonSubmitElement = document.createElement("button");
					$(buttonSubmitElement).attr("type", "submit");
					$(buttonSubmitElement).addClass("btn btn-primary");
					$(buttonSubmitElement).html("<h2>Potvrdi odgovore</h2>");
					$(hdrContainer).append(buttonSubmitElement);

					$('select').on('change', ({currentTarget:target}) => {
						$(`#${dict[target.value.split("-")[1].replace("_CC", "").replace("_TT", "")]}`).hide();
						dict[target.value.split("-")[1].replace("_CC", "").replace("_TT", "")] = `container-${target.value}`;
						$(`#container-${target.value}`).show();
					});

				},
				error: (result) => {
					console.error(result);
				}
			});

			const getRadioOptions = (id) => {
				let radioContainer = document.createElement("div");
				$(radioContainer).addClass("form-check form-check-inline ml-5");
				let inputElement = document.createElement("input");
				$(inputElement).addClass("form-check-input");
				$(inputElement).attr("type", "radio");
				$(inputElement).attr("id", `inline-radio-${id}`);
				$(inputElement).attr("value", id);
				$(inputElement).attr("required", "true");
				$(inputElement).attr("name",
					`radio-name-${id.split("_")[0]}`
				); // opet, imena i slicno prilagoditi datim slikama, eventualno dati samo lijevo desno opciju
				// to bi vjerovatno bilo najbolje, najmanji bias ispitanika
				$(radioContainer).append(inputElement);
				let labelElement = document.createElement("h2");
				$(labelElement).addClass("form-check-label");
				$(labelElement).attr("for", `inline-radio-${id}`);
				$(labelElement).html(id);
				$(radioContainer).append(labelElement);
				return radioContainer;
			};

		});
	</script>
</footer>

</html>